---
title: "Project 1"
author: "Nicole Tucker, Sarah Vreeland, and Sean Froidcoeur"
date: "10/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(broom)
library(readr)
library(MASS)
```
Test

```{r}
# Read in data
health_df <- read_csv("insurance.csv",
                      col_types = cols(sex = col_factor(),
                                      smoker = col_factor(),
                                      region = col_factor()))

```

```{r}
# Age vs Insurance Charges
ggplot(health_df, aes(x = age, y = charges)) +
  geom_point()
```

```{r}
# Sex vs Insurance Charges
ggplot(health_df, aes(x = sex, y = charges)) +
  geom_boxplot()
```

```{r}
# BMI vs Insurance Charges
ggplot(health_df, aes(x = bmi, y = charges)) +
  geom_point()
```

```{r}
# Children vs Insurance Charges
# Not sure what to do here
# don't think we should make children a factor because there is meaning behind the numbers, but it graphs better as a factor
summary(health_df$children)
```

```{r}
# Smoker Status vs Insurance Charges
ggplot(health_df, aes(x = smoker, y = charges)) +
  geom_boxplot()
```

```{r}
# Age vs Insurance Charges with Smoker
ggplot(health_df, aes(x = age, y = charges, color = smoker)) +
  geom_point()
```


```{r}
# Region vs Insurance Charges
ggplot(health_df, aes(x = region, y = charges)) +
  geom_boxplot()
summary(health_df$region)
```

```{r}
no_model <- lm(charges~1, health_df)
full_model <- lm(charges~., health_df)
forward <- stepAIC(no_model, direction = "forward", scope = formula(full_model))
```

```{r}
backward <- stepAIC(full_model, direction = "backward")
```

```{r}
both <- stepAIC(no_model, direction = "both", scope = formula(full_model))
```

```{r}
summary(both)
```

