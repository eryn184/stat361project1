---
title: "Project 1"
author: "Nicole Tucker, Sarah Vreeland, and Sean Froidcoeur"
date: "10/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(broom)
library(readr)
library(MASS)
```

Questions:
Should we take out country since there are so many?

```{r}
# Read in data
heart_df <- read_csv("heart.csv", 
                     col_types = cols(Sex = col_factor(),
                                      ChestPainType = col_factor(),
                                      FastingBS = col_factor(),
                                      RestingECG = col_factor(),
                                      ExerciseAngina = col_factor(),
                                      ST_Slope = col_factor(),
                                      HeartDisease = col_factor()
                                      )
                     ) 
facebook_df <- read_delim("dataset_Facebook.csv", delim = ";")
facebook_df <- facebook_df[,-c(16,17,18)]
life_expectancy_df <- read_csv("Life Expectancy Data.csv")
colnames(life_expectancy_df) = c("country", "year", "status", "life_expectancy",
                                             "adult_mortality", "infant_deaths", "alcohol",
                                             "percentage_expenditure", "hep_b", "measles",
                                             "bmi", "under_five_deaths", "polio", 
                                             "total_expenditure", "diphtheria", "hiv_aids",
                                             "gdp", "population", "thinness_1_19",
                                             "thinness_5_9", "income_comp_of_resources",
                                             "schooling")
health_df <- read_csv("insurance.csv",
                      col_types = cols(sex = col_factor(),
                                      smoker = col_factor(),
                                      region = col_factor()))

```

```{r}
# Age vs Insurance Charges
ggplot(health_df, aes(x = age, y = charges)) +
  geom_point()
```

```{r}
# Sex vs Insurance Charges
ggplot(health_df, aes(x = sex, y = charges)) +
  geom_boxplot()
```

```{r}
# BMI vs Insurance Charges
ggplot(health_df, aes(x = bmi, y = charges)) +
  geom_point()
```

```{r}
# Children vs Insurance Charges
# Not sure what to do here
# don't think we should make children a factor because there is meaning behind the numbers, but it graphs better as a factor
summary(health_df$children)
```

```{r}
# Smoker Status vs Insurance Charges
ggplot(health_df, aes(x = smoker, y = charges)) +
  geom_boxplot()
```

```{r}
# Region vs Insurance Charges
ggplot(health_df, aes(x = region, y = charges)) +
  geom_boxplot()
summary(health_df$region)
```

```{r}
no_model <- lm(charges~1, health_df)
full_model <- lm(charges~., health_df)
forward <- stepAIC(no_model, direction = "forward", scope = formula(full_model))
```

```{r}
backward <- stepAIC(full_model, direction = "backward")
```

```{r}
both <- stepAIC(no_model, direction = "both", scope = formula(full_model))
```

