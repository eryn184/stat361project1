---
title: "STAT361: "
author: "Sean Froidcoeur, Nicole Tucker, and Sarah Vreeland"
date: "November 1st, 2021"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(fig.retina = 3, warning = FALSE, message = FALSE)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_accent(base_color = "#cc002b")
```

## Introduction

```{r load-packages, warning = FALSE, message = FALSE, echo = FALSE}
library(tidyverse)
library(ggthemes)
library(gt)
library(corrplot)
```

Questions we are answering, Background Info
---

## The Data

```{r load-data, warning = FALSE, message = FALSE, echo =FALSE}
insurance<- read_csv("insurance.csv")
insurance$sex <- as.factor(insurance$sex)
insurance$smoker <- as.factor(insurance$smoker)
insurance$region <- as.factor(insurance$region)
```

There's 7 columns with 1338 observations

Categorical variables: Sex, Smoker, Region

Continuous variables: BMI, Age, Children

Response: Charges

Each row and observation is one insured individual.

```{r display-data, warning = FALSE, message = FALSE, echo = FALSE}
gt(insurance)
```

---
#Important Summary Statistics 




---

## BMI and Charges

```{r graph1, warning = FALSE, message = FALSE, echo=FALSE}
insurance %>%
  ggplot(aes(x = bmi, y = charges)) +
  geom_point() +
  theme_bw()
```


---
## Age and Charges 


---
## Children and Charges



---
## Sex and Charges 
```{r graph4, warning=FALSE, message=FALSE, echo=FALSE}
insurance %>%
  ggplot(aes(x = sex, y = charges)) +
  geom_point(position = position_jitter(width = .1, height = 0))
```


---
## Region and Charges
```{r graph5, warning=FALSE, message=FALSE, echo=FALSE}
insurance %>%
  ggplot(aes(x = region, y = charges)) +
  geom_point(position = position_jitter(width = .1, height = 0))
```


---
## Smoker and Charges
```{r graph6, warning=FALSE, message=FALSE, echo=FALSE}
insurance %>%
  ggplot(aes(x = smoker, y = charges)) +
  geom_point(position = position_jitter(width = .1, height = 0))
```


---
## Changing BMI to Categorical

According to the CDC:

Below 18.5	Underweight
18.5 – 24.9	Healthy Weight
25.0 – 29.9	Overweight
30.0 and Above	Obesity

```{r bmicat, warning=TRUE, message=FALSE, echo=FALSE, fig.align='top'}
insurance <- insurance %>%
  mutate(bmi_categories = case_when(
    bmi >= 30 ~ "Obesity",
    bmi >= 25 ~ "Overweight",
    bmi >= 18.5 ~ "Healthy Weight",
    TRUE ~ "Underweight"
  ))
insurance$bmi_categories <- as.factor(insurance$bmi_categories)
insurance %>%
  ggplot(aes(x = age, y = charges, col = bmi_categories)) +
  geom_point(alpha = 0.6, size = 2.5)
```
---
## Models Using Step AIC



---
## Incorporating Interaction Terms


---
## Checking AOV

---
## Final Model

---

## Residual Analysis


---
## Conclusion